<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Gestión Docente - Acceso</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>

    <header>
        <img src="logo1.png" alt="Logo de la Institución">
        <h1>MercedAPP</h1>
        <nav>
            <ul>
                <li><a href="index.html">Inicio</a></li>
                <li><a href="dashboard.html">Dashboard</a></li>
                <li><a href="notifications.html">Notificaciones</a></li>
                <li><a href="calendar.html">Calendario</a></li>
                <li><a href="chat.html">Chat</a></li>
                <li><a href="evaluations.html">Evaluaciones</a></li>
            </ul>
        </nav>
    </header>

    <main>
        <section class="introduccion">
            <h2>¡Bienvenidos Profesores!</h2>
            <p>MercedAPP es su plataforma digital para gestionar todas las actividades docentes. Acceda a sus comunicaciones, horarios, evaluaciones y recursos educativos de manera segura y eficiente.</p>
        </section>

        <section class="login-form">
            <h3>Iniciar Sesión</h3>
            <form id="loginForm" onsubmit="loginTeacher(event)">

                <label for="usuario">Código Docente o Email:</label>
                <input type="text" id="usuario" name="usuario" required>

                <br><br>

                <label for="password">Contraseña:</label>
                <input type="password" id="password" name="password" required>

                <br><br>

                <button type="submit">Acceder al Panel</button>

                <p class="olvido-contrasena"><a href="#">¿Olvidó su contraseña?</a></p>
            </form>
        </section>

        <section class="registration-form">
            <h3>Registro de Nuevo Profesor</h3>
            <p>Complete sus datos para registrarse en el sistema docente.</p>

            <form id="registrationForm" onsubmit="registerTeacher(event)">
                <div class="form-row">
                    <div class="form-group">
                        <label for="regNombre">Nombre Completo:</label>
                        <input type="text" id="regNombre" name="nombre" required>
                    </div>

                    <div class="form-group">
                        <label for="regEmail">Email Institucional:</label>
                        <input type="email" id="regEmail" name="email" required>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="regCodigo">Código Docente:</label>
                        <input type="text" id="regCodigo" name="codigo" required>
                    </div>

                    <div class="form-group">
                        <label for="regEspecialidad">Especialidad/Materia:</label>
                        <select id="regEspecialidad" name="especialidad" required>
                            <option value="">Seleccionar...</option>
                            <option value="matematicas">Matemáticas</option>
                            <option value="ciencias">Ciencias</option>
                            <option value="idiomas">Idiomas</option>
                            <option value="historia">Historia</option>
                            <option value="geografia">Geografía</option>
                            <option value="educacion-fisica">Educación Física</option>
                            <option value="artes">Artes</option>
                            <option value="musica">Música</option>
                            <option value="informatica">Informática</option>
                            <option value="otra">Otra</option>
                        </select>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="regTelefono">Teléfono:</label>
                        <input type="tel" id="regTelefono" name="telefono">
                    </div>

                    <div class="form-group">
                        <label for="regDepartamento">Departamento:</label>
                        <select id="regDepartamento" name="departamento" required>
                            <option value="">Seleccionar...</option>
                            <option value="primaria">Primaria</option>
                            <option value="secundaria">Secundaria</option>
                            <option value="bachillerato">Bachillerato</option>
                            <option value="especial">Educación Especial</option>
                            <option value="administrativo">Administrativo</option>
                        </select>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="regPassword">Contraseña:</label>
                        <input type="password" id="regPassword" name="password" required minlength="6">
                    </div>

                    <div class="form-group">
                        <label for="regConfirmPassword">Confirmar Contraseña:</label>
                        <input type="password" id="regConfirmPassword" name="confirmPassword" required minlength="6">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group full-width">
                        <label for="regExperiencia">Años de Experiencia:</label>
                        <input type="number" id="regExperiencia" name="experiencia" min="0" max="50">
                    </div>
                </div>

                <button type="submit" style="width: 100%; margin-top: 1rem;">Registrarse</button>
            </form>
        </section>
    </main>

    <footer>
        <p>&copy; 2025 MercedAPP - Sistema de Gestión Docente</p>
    </footer>

    <!-- Emergency Button -->
    <button class="emergency-button" onclick="showEmergencyModal()" title="Emergencia - Llamar al 911">🚨</button>

    <div class="emergency-modal" id="emergencyModal">
        <div class="emergency-content">
            <h2>🚨 EMERGENCIA</h2>
            <p>¿Está seguro que desea llamar al servicio de emergencias 911?</p>
            <div class="emergency-buttons">
                <button class="emergency-call" onclick="callEmergency()">Llamar 911</button>
                <button class="emergency-cancel" onclick="hideEmergencyModal()">Cancelar</button>
            </div>
        </div>
    </div>

    <script>
        // Teacher data storage using localStorage
        let teachers = JSON.parse(localStorage.getItem('teachers')) || [];

        function registerTeacher(event) {
            event.preventDefault();

            const formData = new FormData(event.target);
            const teacherData = {
                id: Date.now().toString(),
                nombre: formData.get('nombre'),
                email: formData.get('email'),
                codigo: formData.get('codigo'),
                especialidad: formData.get('especialidad'),
                telefono: formData.get('telefono'),
                departamento: formData.get('departamento'),
                password: formData.get('password'),
                experiencia: formData.get('experiencia') || 0,
                fechaRegistro: new Date().toISOString(),
                activo: true
            };

            // Validate password confirmation
            if (formData.get('password') !== formData.get('confirmPassword')) {
                alert('Las contraseñas no coinciden');
                return;
            }

            // Check if email or code already exists
            const existingTeacher = teachers.find(t =>
                t.email === teacherData.email || t.codigo === teacherData.codigo
            );

            if (existingTeacher) {
                alert('Ya existe un profesor registrado con este email o código docente');
                return;
            }

            // Add teacher to array
            teachers.push(teacherData);

            // Save to localStorage
            localStorage.setItem('teachers', JSON.stringify(teachers));

            // Clear form
            event.target.reset();

            alert('Profesor registrado exitosamente. Ahora puede iniciar sesión.');

            // Update chat contacts if chat is loaded
            updateChatContacts();
        }

        function loginTeacher(event) {
            event.preventDefault();

            const usuario = document.getElementById('usuario').value;
            const password = document.getElementById('password').value;

            // Find teacher by email or code
            const teacher = teachers.find(t =>
                (t.email === usuario || t.codigo === usuario) && t.password === password && t.activo
            );

            if (teacher) {
                // Store current user session
                localStorage.setItem('currentUser', JSON.stringify(teacher));

                // Redirect to dashboard
                window.location.href = 'dashboard.html';
            } else {
                alert('Credenciales incorrectas o usuario no encontrado');
            }
        }

        function updateChatContacts() {
            // This function will be called when chat page loads to update contacts
            if (typeof window.updateContactsList === 'function') {
                window.updateContactsList(teachers);
            }
        }

        // Emergency functions
        function showEmergencyModal() {
            document.getElementById('emergencyModal').classList.add('show');
        }

        function hideEmergencyModal() {
            document.getElementById('emergencyModal').classList.remove('show');
        }

        function callEmergency() {
            // In a real application, this would initiate a phone call
            // For web browsers, we'll open the phone dialer or show instructions
            if (confirm('¿Desea llamar al 911? Esto abrirá su aplicación de teléfono.')) {
                window.location.href = 'tel:911';
            }
            hideEmergencyModal();
        }

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            updateChatContacts();
        });
    </script>

</body>
</html>
